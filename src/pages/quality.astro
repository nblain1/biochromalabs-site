---
import Layout from '../layouts/Layout.astro';
import CTA from '../components/CTA.astro';
import { siteData } from '../data/siteData';

const qseDeepDive = [
  {
    id: 'governance',
    title: 'Governance & Accountability',
    subtitle: 'Organization',
    icon: 'ri-organization-chart',
    summary: 'Defined responsibilities and escalation pathways that ensure management commitment to quality.',
    details: [
      'Accountability: Designated Quality Manager with direct reporting lines to executive leadership, independent of production.',
      'Audit Readiness: Internal audit schedules and management review cycles to identify and remediate system variances proactively.',
      'Ethics & Impartiality: Strict policies governing the prevention of commercial or financial pressures on analytical results.'
    ]
  },
  {
    id: 'competency',
    title: 'Technical Competency',
    subtitle: 'Personnel',
    icon: 'ri-user-star-line',
    summary: 'Role-based training and continuous qualification programs for every analyst in the lab.',
    details: [
      'Training Records: Centralized matrix tracking initial training, annual re-qualification, and method-specific competency.',
      'Technical Oversight: Peer-review system for 100% of raw data and final reports to ensure interpretation accuracy.',
      'Safety & Compliance: Standardized onboarding covering GLP/GMP principles and facility-specific safety protocols.'
    ]
  },
  {
    id: 'infrastructure',
    title: 'Lifecycle Management',
    subtitle: 'Equipment',
    icon: 'ri-settings-5-line',
    summary: 'Systematic controls for the qualification, calibration, and preventive maintenance of lab hardware.',
    details: [
      'IQ/OQ/PQ: Formal installation, operational, and performance qualification for all high-complexity instrumentation.',
      'Traceability: External calibration of critical measurement tools (balances, pipettes, timers) traceable to NIST standards.',
      'Maintenance: Automated scheduling for preventive maintenance to minimize downtime and prevent analytical drift.'
    ]
  },
  {
    id: 'traceability',
    title: 'Knowledge Management',
    subtitle: 'Documents & Records',
    icon: 'ri-file-search-line',
    summary: 'Version-controlled systems that ensure data is attributable, legible, and readily retrievable.',
    details: [
      'Document Control: Standardized SOP workflows with formal change control, versioning, and archivist oversight.',
      'Data Integrity: ALCOA+ principles applied to all electronic and paper records to ensure permanent and accurate data.',
      'Retention: Managed archival system for samples and records following defined regulatory retention schedules.'
    ]
  }
];
---

<Layout
  title={`Quality & Compliance - ${siteData.name}`}
  description="ISO 17025-aligned quality systems supporting defensible, audit-ready analytical data."
>
  <section class="home-hero">
    <div class="home-shell">
      <nav class="breadcrumb" aria-label="Breadcrumb">
        <a href="/">Home</a>
        <span aria-hidden="true">&gt;</span>
        <span class="text-emerald-400 opacity-80">Quality</span>
      </nav>

      <div class="hero-grid mb-16">
        <div class="hero-copy">
          <p class="hero-eyebrow">Systems & Compliance</p>
          <h1>Built for defensible, inspection-ready data.</h1>
          <p class="hero-lead">
            Our quality framework aligns with <strong>ISO 17025</strong> principles. We provide the technical validity and traceable reporting required for complex regulatory submissions.
          </p>
          
          <div class="flex flex-col gap-6 bg-emerald-500/5 border border-emerald-500/20 p-8 rounded-xl mt-8 max-w-lg">
            <div class="flex items-center gap-5">
              <i class="ri-award-fill text-4xl text-emerald-400"></i>
              <div>
                <strong class="block text-lg text-white">ISO/IEC 17025 Principles</strong>
                <span class="text-sm text-slate-400">Quality Management Alignment</span>
              </div>
            </div>
            <a href="/documents/iso-cert.pdf" target="_blank" rel="noopener noreferrer" class="flex items-center justify-center gap-2 bg-white/5 hover:bg-emerald-500/15 text-white hover:text-emerald-400 p-3 rounded-lg text-sm font-semibold transition-colors border border-white/5">
              Download Scope PDF <i class="ri-download-2-line text-lg"></i>
            </a>
          </div>
        </div>

        <div class="hero-media-frame">
          <img src="https://images.unsplash.com/photo-1582719508461-905c673771fd?w=800&q=80" alt="ISO 17025 Quality Control Data Review at BioChroma Analytical Labs" loading="eager" />
          <div class="hero-media-caption">
            <p>Data Integrity Focus</p>
            <span>100% peer-review on all analytical datasets.</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="home-section chapter-section">
    <div class="home-shell">
      <div class="section-heading">
        <p>Operational Guardrails</p>
        <h2>Quality System Elements (QSE)</h2>
      </div>
      
      

      <div class="chapter-stack">
        {qseDeepDive.map((item) => (
          <details id={item.id} class="chapter-item group">
            <summary class="hover:bg-white/5 transition-colors rounded-t-lg">
              <div class="summary-content">
                <strong>{item.title}</strong>
                <span class="chapter-subtitle block mt-1">{item.subtitle}</span>
              </div>
              <i class="ri-add-line toggle-icon"></i>
            </summary>
            <div class="details-content">
              <p class="qse-summary">{item.summary}</p>
              <ul class="aligned-list">
                {item.details.map((detail) => {
                  const [label, ...textParts] = detail.split(': ');
                  return (
                    <li class="aligned-item">
                      <span class="item-label text-white font-bold">{label}:</span>
                      <span class="item-text text-slate-300">{textParts.join(': ')}</span>
                    </li>
                  );
                })}
              </ul>
            </div>
          </details>
        ))}
      </div>
    </div>
  </section>

  <section class="home-section">
    <div class="home-shell">
      <CTA
        title="Need to verify our credentials?"
        description="We provide full ISO 17025 scopes of accreditation, SOP overviews, and sample submission guidelines for your QA team."
        primaryLabel="Contact Quality Team"
        primaryHref="/contact"
        secondaryLabel="View Testing Capabilities"
        secondaryHref="/capabilities"
      />
    </div>
  </section>
</Layout>

<style>
  /* Deep Dive Accordions & Alignment List (Standardized with Capabilities) */
  .chapter-stack { display: flex; flex-direction: column; gap: 1rem; max-width: 1000px; margin-top: 2rem; }
  .chapter-item { background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.05); border-radius: 8px; overflow: hidden; transition: border-color 0.3s ease; }
  .chapter-item summary { padding: 1.5rem 2rem; cursor: pointer; display: flex; justify-content: space-between; align-items: center; list-style: none; user-select: none; }
  .chapter-item summary::-webkit-details-marker { display: none; }
  .chapter-subtitle { font-size: 0.75rem; color: var(--color-primary); text-transform: uppercase; letter-spacing: 0.05em; }
  .toggle-icon { font-size: 1.5rem; color: rgba(255, 255, 255, 0.2); transition: 0.3s; }
  
  .chapter-item[open] { border-color: rgba(36, 199, 143, 0.4); }
  .chapter-item[open] .toggle-icon { transform: rotate(45deg); color: var(--color-primary); }

  /* FIXED ALIGNMENT LIST */
  .details-content { padding: 0 2rem 2rem 2rem; border-top: 1px solid rgba(255, 255, 255, 0.05); padding-top: 2rem; }
  .qse-summary { color: var(--color-primary); font-weight: 500; margin-bottom: 2rem; font-size: 1.1rem; }
  
  .aligned-list { list-style: none; padding: 0; display: flex; flex-direction: column; gap: 1.5rem; }
  .aligned-item { display: flex; flex-direction: column; gap: 0.25rem; }

  @media (min-width: 768px) {
    .aligned-item { flex-direction: row; gap: 1.5rem; }
    .item-label { min-width: 240px; flex-shrink: 0; }
  }
</style>

<script>
  // Ensure only one accordion is open at a time
  document.addEventListener('DOMContentLoaded', () => {
    const details = document.querySelectorAll('.chapter-item');
    details.forEach((targetDetail) => {
      targetDetail.addEventListener('click', () => {
        details.forEach((detail) => {
          if (detail !== targetDetail) { detail.removeAttribute('open'); }
        });
      });
    });
  });
</script>