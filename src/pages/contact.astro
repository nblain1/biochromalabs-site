---
import { Image } from 'astro:assets';
import Layout from '../layouts/Layout.astro';
import { pageCopy, pageData, site } from '../data/content';

// Import local assets
// Ensure you have a contact-hero.jpg in src/assets/
import contactHero from '../assets/contact-hero.jpg';

const copy = pageCopy.contact;
const data = pageData.contact;

// Icons for the top-level action cards
const actionCardIcons = ['ri-flask-line', 'ri-mail-open-line'];
---

<Layout 
  title={copy.frontmatter.layoutTitle} 
  description={copy.frontmatter.layoutDescription}
>
  
  <section class="home-hero">
    <div class="home-shell">
      <nav class="breadcrumb reveal-up" aria-label="Breadcrumb">
        <a href="/">Home</a>
        <span aria-hidden="true">&gt;</span>
        <span class="text-emerald-400 opacity-80">Contact</span>
      </nav>

      <div class="hero-grid">
        <div class="hero-copy reveal-up" style="transition-delay: 100ms;">
          <p class="hero-eyebrow">{copy.frontmatter.heroEyebrow}</p>
          <h1>{copy.frontmatter.heroTitle}</h1>
          <p class="hero-lead">{copy.frontmatter.heroLead}</p>
        </div>

        <aside class="hero-media-frame reveal-scale" style="transition-delay: 200ms;" aria-label="Client Support">
          <Image 
            src={contactHero} 
            alt="BioChroma Client Consultation" 
            loading="eager" 
            class="w-full h-full object-cover rounded-2xl"
          />
          <div class="hero-media-caption">
            <p>{copy.frontmatter.heroMediaTitle}</p>
            <span>{copy.frontmatter.heroMediaText}</span>
          </div>
        </aside>
      </div>
    </div>
  </section>

  {copy.Content && (
    <section class="home-section border-t border-white/5 bg-slate-900/20">
      <div class="home-shell">
        <div class="prose prose-invert prose-emerald max-w-4xl mx-auto text-center text-lg leading-relaxed text-slate-300 reveal-up">
          <copy.Content />
        </div>
      </div>
    </section>
  )}

  <section class="home-section border-t border-white/5">
    <div class="home-shell">
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-20">
        {data.actionCards.map((card, index) => (
          <a 
            href={`mailto:${card.email}`} 
            class="group bg-white/5 border border-white/10 p-8 rounded-xl hover:bg-emerald-500/5 hover:border-emerald-400/30 transition-all duration-300 reveal-up"
            style={`transition-delay: ${index * 150}ms;`}
          >
            <div class="w-12 h-12 rounded-lg bg-emerald-500/10 flex items-center justify-center text-emerald-400 text-xl mb-6 group-hover:scale-110 transition-transform">
              <i class={actionCardIcons[index] || 'ri-mail-send-line'}></i>
            </div>
            <h3 class="text-white text-xl font-bold mb-2">{card.title}</h3>
            <p class="text-slate-400 leading-relaxed mb-6">{card.description}</p>
            <span class="inline-flex items-center gap-2 text-emerald-400 font-semibold text-sm group-hover:translate-x-1 transition-transform">
              {card.email} <i class="ri-arrow-right-up-line"></i>
            </span>
          </a>
        ))}
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-3 gap-12 items-start">
        
        <div class="lg:col-span-2 reveal-up">
          <h2 class="text-2xl font-bold text-white mb-8 border-l-4 border-emerald-500 pl-4">
            {copy.frontmatter.directoryTitle}
          </h2>
          <div class="flex flex-col gap-4">
            {data.departmentEmails.map((dept, index) => (
              <a 
                href={`mailto:${dept.email}`} 
                class="group flex flex-col md:flex-row md:items-center justify-between p-6 bg-white/5 border border-white/10 rounded-xl hover:border-emerald-400/30 hover:bg-white/10 transition-all duration-300 reveal-up"
                style={`transition-delay: ${(index * 50) + 200}ms;`}
              >
                <div>
                  <span class="block text-white font-semibold text-lg mb-1 group-hover:text-emerald-400 transition-colors">
                    {dept.department}
                  </span>
                  <span class="text-emerald-400/80 text-sm font-mono">{dept.email}</span>
                </div>
                <p class="text-slate-400 text-sm m-0 mt-3 md:mt-0 italic opacity-80">
                  {dept.description}
                </p>
              </a>
            ))}
          </div>
        </div>

        <aside class="bg-slate-900/50 border border-white/10 p-8 rounded-xl reveal-up" style="transition-delay: 300ms;">
          <h3 class="text-white mb-6 text-sm uppercase tracking-widest font-bold border-b border-white/10 pb-4">
            {copy.frontmatter.headquartersTitle}
          </h3>
          
          <div class="space-y-6">
            <div class="flex gap-4 group">
              <i class="ri-map-pin-line text-emerald-400 text-xl mt-1"></i>
              <a 
                href={data.headquarters.mapUrl} 
                target="_blank" 
                rel="noopener noreferrer" 
                class="text-slate-300 text-sm leading-relaxed group-hover:text-white transition-colors"
              >
                {data.headquarters.addressLines.map((line) => (
                  <span class="block">{line}</span>
                ))}
              </a>
            </div>
            
            <div class="flex gap-4 group">
              <i class="ri-phone-line text-emerald-400 text-xl mt-1"></i>
              <a 
                href={`tel:${site.phone}`} 
                class="text-slate-300 text-sm group-hover:text-white transition-colors"
              >
                {site.phone}
              </a>
            </div>
            
            <div class="flex gap-4">
              <i class="ri-time-line text-emerald-400 text-xl mt-1"></i>
              <p class="text-slate-300 text-sm">{data.headquarters.hours}</p>
            </div>
          </div>
          
          <div class="mt-8 pt-6 border-t border-white/10 flex gap-4 bg-emerald-500/5 p-4 rounded-lg">
            <i class="ri-information-line text-emerald-400 text-xl"></i>
            <p class="text-xs text-slate-400 leading-relaxed">
              {data.headquarters.responseNote}
            </p>
          </div>
        </aside>
        
      </div>
    </div>
  </section>
</Layout>

<style>
  .breadcrumb { font-size: 0.875rem; margin-bottom: 2rem; display: flex; gap: 0.5rem; }
  .breadcrumb a { color: rgba(255, 255, 255, 0.6); text-decoration: none; transition: 0.2s; }
  .breadcrumb a:hover { color: var(--color-primary); }

  /* --- Scroll Reveal Animations --- */
  @media (prefers-reduced-motion: no-preference) {
    .reveal-up {
      opacity: 0;
      transform: translateY(30px);
      transition: opacity 0.8s cubic-bezier(0.25, 1, 0.5, 1), transform 0.8s cubic-bezier(0.25, 1, 0.5, 1);
    }
    .reveal-scale {
      opacity: 0;
      transform: scale(0.95);
      transition: opacity 1s cubic-bezier(0.25, 1, 0.5, 1), transform 1s cubic-bezier(0.25, 1, 0.5, 1);
    }
    
    .reveal-up.active,
    .reveal-scale.active {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // --- Scroll Reveal Observer ---
    const observerOptions = {
      root: null,
      rootMargin: '0px 0px -50px 0px', 
      threshold: 0.1
    };

    const observer = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('active');
          observer.unobserve(entry.target); 
        }
      });
    }, observerOptions);

    const elementsToReveal = document.querySelectorAll('.reveal-up, .reveal-scale');
    elementsToReveal.forEach(el => observer.observe(el));
  });
</script>